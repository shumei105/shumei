<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>è‚²æ‰äº‘å›¾</title>
<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2/dist/echarts-wordcloud.min.js"></script>
<style>
  :root{ font-size: 16px; }
  *{ box-sizing: border-box; margin:0; padding:0; }
  body{
    background:#0b1220; color:#dbe5ff; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    overflow-x:hidden;
  }
  .screen{
    width:100vw; height:100vh; display:flex; flex-direction:column; padding:0.6rem;
    gap:0.6rem;
  }
  .header{
    display:flex; align-items:center; justify-content:center; /* ä¿®æ”¹ä¸ºå±…ä¸­ */
    padding:0.6rem 0.8rem;
    background:linear-gradient(90deg,#0e1830,#0b1220); border:1px solid #1b2744; border-radius:12px;
    box-shadow:0 4px 20px rgba(0,0,0,.35);
    position: relative; /* æ·»åŠ ç›¸å¯¹å®šä½ */
  }
  .header .title{ 
    font-size:1.25rem; letter-spacing:.06rem; font-weight:700; 
    text-align: center; /* ç¡®ä¿æ–‡æœ¬å±…ä¸­ */
  }
  .header .meta{ 
    position: absolute; /* ç»å¯¹å®šä½ */
    right: 0.8rem; /* è·ç¦»å³ä¾§ */
    top: 50%; /* å‚ç›´å±…ä¸­ */
    transform: translateY(-50%); /* å‚ç›´å±…ä¸­è°ƒæ•´ */
    display: flex;
    align-items: center;
    gap: 15px;
    opacity:.85; font-size:.9rem; 
  }
  .content{ 
    flex:1; 
    display:grid; 
    grid-template-columns: 25% 50% 25%; 
    gap:0.6rem; 
    min-height:0; 
  }
  .col{ display:flex; flex-direction:column; gap:0.6rem; min-height:0; }
  .panel{
    flex:1; min-height:0; background:#0e1830; border:1px solid #1b2744; border-radius:12px;
    padding:0.6rem; display:flex; flex-direction:column; gap:0.5rem;
    transition: all 0.3s ease;
  }
  .panel:hover {
    box-shadow: 0 0 15px rgba(79, 195, 247, 0.3);
    border-color: #2a3c65;
  }
  .panel h3{
    font-size:1rem; font-weight:600; letter-spacing:.04rem; color:#90c4ff; 
    display:flex; align-items:center; justify-content: space-between;
  }
  .chart{ flex:1; min-height:200px; }
  .footer{
    text-align:center; opacity:.65; font-size:.85rem; padding:.2rem 0;
  }
  .bar { height:3px; background:linear-gradient(90deg,#4fc3f7,#7c4dff); border-radius:2px; }

  /* AIåˆ†ææŒ‰é’®æ ·å¼ */
  .ai-button {
    background: linear-gradient(90deg, #4fc3f7, #7c4dff);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .ai-button:hover {
    box-shadow: 0 0 12px rgba(79, 195, 247, 0.5);
    transform: translateY(-2px);
  }
  .ai-button .icon {
    font-size: 16px;
  }

  /* å…¨å›½é«˜æ ¡æŒ‰é’®æ ·å¼ */
  .national-button {
    background: linear-gradient(90deg, #66bb6a, #43a047);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .national-button:hover {
    box-shadow: 0 0 12px rgba(102, 187, 106, 0.5);
    transform: translateY(-2px);
  }
  .national-button .icon {
    font-size: 16px;
  }

  /* é«˜æ ¡æŒ‡æ ‡æŒ‰é’®æ ·å¼ */
  .indicator-button {
    background: linear-gradient(90deg, #ab47bc, #8e24aa);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .indicator-button:hover {
    box-shadow: 0 0 12px rgba(171, 71, 188, 0.5);
    transform: translateY(-2px);
  }
  .indicator-button .icon {
    font-size: 16px;
  }

  /* çœä»½ä¿¡æ¯é¢æ¿ */
  #provinceInfo {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 320px;
    background: rgba(14, 24, 48, 0.95);
    border: 2px solid #4fc3f7;
    border-radius: 12px;
    padding: 20px;
    z-index: 1000;
    box-shadow: 0 0 30px rgba(79, 195, 247, 0.5);
    backdrop-filter: blur(10px);
    display: none;
  }
  #provinceInfo h2 {
    color: #4fc3f7;
    margin-bottom: 15px;
    text-align: center;
    border-bottom: 1px solid #334;
    padding-bottom: 10px;
  }
  #provinceInfo .info-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    padding: 8px;
    background: rgba(27, 39, 68, 0.4);
    border-radius: 6px;
  }
  #provinceInfo .close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 24px;
    color: #dbe5ff;
    cursor: pointer;
    background: none;
    border: none;
    transition: color 0.3s;
  }
  #provinceInfo .close-btn:hover {
    color: #4fc3f7;
  }
  
  /* å°å±é€‚é… */
  @media (max-width: 1200px){
    .content{ grid-template-columns:1fr; overflow:auto; }
    #provinceInfo {
      width: 90%;
      max-width: 320px;
    }
    .header .meta {
      position: static; /* æ¢å¤é»˜è®¤å®šä½ */
      transform: none; /* å–æ¶ˆå˜æ¢ */
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
    }
    .header {
      justify-content: space-between; /* å°å±æ¢å¤åŸæœ‰å¸ƒå±€ */
      flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
    }
    .header .title {
      width: 100%; /* æ ‡é¢˜å æ»¡å®½åº¦ */
      text-align: center; /* æ–‡æœ¬å±…ä¸­ */
      margin-bottom: 10px; /* æ·»åŠ åº•éƒ¨é—´è· */
    }
  }
  
  /* é«˜äº®æ•ˆæœ */
  .highlight {
    box-shadow: 0 0 15px rgba(79, 195, 247, 0.7);
    transform: scale(1.02);
    z-index: 10;
  }
  
  /* åŠ¨ç”»æ•ˆæœ */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  .fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }
</style>
</head>
<body>
<div class="screen">
  <div class="header">
    <div class="title">è‚²æ‰äº‘å›¾</div> <!-- ä¿®æ”¹æ ‡é¢˜ -->
    <div class="meta">
      <div id="clock">--:--:--</div>
      <button class="national-button" id="national-btn">
        <span class="icon">ğŸ«</span>
        <span>å…¨å›½é«˜æ ¡</span>
      </button>
      <button class="indicator-button" id="indicator-btn">
        <span class="icon">ğŸ“Š</span>
        <span>é«˜æ ¡æŒ‡æ ‡</span>
      </button>
      <button class="ai-button" id="ai-analysis-btn">
        <span class="icon">ğŸ¤–</span>
        <span>AIåˆ†æ</span>
      </button>
    </div>
  </div>

  <div class="content">
    <!-- å·¦åˆ— -->
    <div class="col">
      <div class="panel">
        <h3>æ•™è‚²å‘å±•æŒ‡æ•°ï¼ˆGaugeï¼‰</h3>
        <div class="bar"></div>
        <div id="gauge" class="chart"></div>
      </div>
      <div class="panel">
        <h3>é«˜æ ¡ç±»å‹åˆ†å¸ƒï¼ˆPieï¼‰</h3>
        <div class="bar"></div>
        <div id="pie" class="chart"></div>
      </div>
    </div>

    <!-- ä¸­åˆ— -->
    <div class="col">
      <div class="panel" style="flex:1">
        <h3>ä¸­å›½é«˜æ ¡åˆ†å¸ƒï¼ˆMapï¼‰</h3>
        <div class="bar"></div>
        <div id="map" class="chart"></div>
      </div>
    </div>

    <!-- å³åˆ— -->
    <div class="col">
      <div class="panel">
        <h3>é«˜æ ¡ç»¼åˆå®åŠ›ï¼ˆRadarï¼‰</h3>
        <div class="bar"></div>
        <div id="radar" class="chart"></div>
      </div>
      <div class="panel">
        <h3>çƒ­è¯äº‘ï¼ˆWord Cloudï¼‰</h3>
        <div class="bar"></div>
        <div id="wordcloud" class="chart"></div>
      </div>
    </div>
  </div>

  <div class="footer">åŸºäºçœŸå®é«˜æ ¡æ•°æ®å¯è§†åŒ–åˆ†æ</div>
</div>

<!-- çœä»½ä¿¡æ¯é¢æ¿ -->
<div id="provinceInfo">
  <button class="close-btn">&times;</button>
  <h2 id="provinceName">çœä»½ä¿¡æ¯</h2>
  <div class="info-row">
    <span>985é«˜æ ¡æ•°é‡:</span>
    <span id="985Count">0</span>
  </div>
  <div class="info-row">
    <span>211é«˜æ ¡æ•°é‡:</span>
    <span id="211Count">0</span>
  </div>
  <div class="info-row">
    <span>åŒä¸€æµé«˜æ ¡æ•°é‡:</span>
    <span id="doubleFirstCount">0</span>
  </div>
  <div class="info-row">
    <span>æ•™è‚²å‘å±•æŒ‡æ•°:</span>
    <span id="eduIndex">0</span>
  </div>
</div>

<script>
  // å®æ—¶æ—¶é’Ÿ
  const clockEl = document.getElementById('clock');
  const tick = () => {
    const d = new Date();
    const pad = n => n.toString().padStart(2,'0');
    clockEl.textContent = `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
  };
  tick(); setInterval(tick, 1000);

  // AIåˆ†ææŒ‰é’®ç‚¹å‡»äº‹ä»¶
  document.getElementById('ai-analysis-btn').addEventListener('click', function() {
    window.location.href = 'http://127.0.0.1:5000';
  });

  // å…¨å›½é«˜æ ¡æŒ‰é’®ç‚¹å‡»äº‹ä»¶
  document.getElementById('national-btn').addEventListener('click', function() {
    window.location.href = 'ç¬¬äºŒé¡µé¢.html';
  });

  // é«˜æ ¡æŒ‡æ ‡æŒ‰é’®ç‚¹å‡»äº‹ä»¶ - æ–°å¢åŠŸèƒ½
  document.getElementById('indicator-btn').addEventListener('click', function() {
    window.location.href = 'ç¬¬ä¸‰é¡µé¢.html';
  });

  // ç»Ÿä¸€åˆå§‹åŒ–æ–¹æ³•
  function init(id){ return echarts.init(document.getElementById(id)); }

  // é«˜æ ¡æ•°æ®é›† - æ›´æ–°ä¸ºåŒ…å«åŒä¸€æµæ•°æ®
  const universityData = [
    {name: 'åŒ—äº¬å¸‚', value985: 8, value211: 18, valueDoubleFirst: 34, types: [
      {value: 15, name: 'ç»¼åˆç±»'}, {value: 8, name: 'ç†å·¥ç±»'}, {value: 3, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'ä¸Šæµ·å¸‚', value985: 4, value211: 6, valueDoubleFirst: 15, types: [
      {value: 6, name: 'ç»¼åˆç±»'}, {value: 3, name: 'ç†å·¥ç±»'}, {value: 1, name: 'è´¢ç»ç±»'}
    ]},
    {name: 'é™•è¥¿çœ', value985: 3, value211: 5, valueDoubleFirst: 8, types: [
      {value: 4, name: 'ç»¼åˆç±»'}, {value: 3, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æ¹–å—çœ', value985: 3, value211: 1, valueDoubleFirst: 5, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æ±Ÿè¥¿çœ', value985: 2, value211: 1, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å±±ä¸œçœ', value985: 2, value211: 1, valueDoubleFirst: 4, types: [
      {value: 4, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'è¾½å®çœ', value985: 2, value211: 2, valueDoubleFirst: 4, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'é’æµ·çœ', value985: 2, value211: 1, valueDoubleFirst: 1, types: [
      {value: 1, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}
    ]},
    {name: 'æ¹–åŒ—çœ', value985: 2, value211: 4, valueDoubleFirst: 7, types: [
      {value: 5, name: 'ç»¼åˆç±»'}, {value: 3, name: 'ç†å·¥ç±»'}, {value: 2, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æ±Ÿè‹çœ', value985: 2, value211: 9, valueDoubleFirst: 16, types: [
      {value: 8, name: 'ç»¼åˆç±»'}, {value: 6, name: 'ç†å·¥ç±»'}, {value: 3, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å››å·çœ', value985: 2, value211: 3, valueDoubleFirst: 8, types: [
      {value: 4, name: 'ç»¼åˆç±»'}, {value: 3, name: 'ç†å·¥ç±»'}, {value: 2, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å¤©æ´¥å¸‚', value985: 2, value211: 1, valueDoubleFirst: 6, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'è´¢ç»ç±»'}
    ]},
    {name: 'å¹¿ä¸œçœ', value985: 2, value211: 2, valueDoubleFirst: 8, types: [
      {value: 4, name: 'ç»¼åˆç±»'}, {value: 3, name: 'ç†å·¥ç±»'}, {value: 2, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'é‡åº†å¸‚', value985: 1, value211: 1, valueDoubleFirst: 2, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æµ™æ±Ÿçœ', value985: 1, value211: 0, valueDoubleFirst: 3, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'ç”˜è‚ƒçœ', value985: 1, value211: 0, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å®‰å¾½çœ', value985: 1, value211: 2, valueDoubleFirst: 3, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å‰æ—çœ', value985: 1, value211: 1, valueDoubleFirst: 3, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'ç¦å»ºçœ', value985: 1, value211: 1, valueDoubleFirst: 2, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'é»‘é¾™æ±Ÿçœ', value985: 1, value211: 3, valueDoubleFirst: 4, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'äº‘å—çœ', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'è¥¿è—è‡ªæ²»åŒº', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 1, name: 'ç»¼åˆç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å†…è’™å¤è‡ªæ²»åŒº', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'è´µå·çœ', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å®å¤å›æ—è‡ªæ²»åŒº', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 1, name: 'ç»¼åˆç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', value985: 0, value211: 2, valueDoubleFirst: 2, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å±±è¥¿çœ', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æ²³åŒ—çœ', value985: 0, value211: 1, valueDoubleFirst: 2, types: [
      {value: 3, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æ²³å—çœ', value985: 0, value211: 1, valueDoubleFirst: 2, types: [
      {value: 4, name: 'ç»¼åˆç±»'}, {value: 2, name: 'ç†å·¥ç±»'}, {value: 2, name: 'å¸ˆèŒƒç±»'}
    ]},
    {name: 'æµ·å—çœ', value985: 0, value211: 1, valueDoubleFirst: 1, types: [
      {value: 2, name: 'ç»¼åˆç±»'}, {value: 1, name: 'ç†å·¥ç±»'}, {value: 1, name: 'å¸ˆèŒƒç±»'}
    ]}
  ];

  // è®¡ç®—æ•™è‚²å‘å±•æŒ‡æ•° (åŸºäº985ã€211å’ŒåŒä¸€æµæ•°é‡)
  universityData.forEach(province => {
    province.eduIndex = Math.round((province.value985 * 60 + province.value211 * 30 + province.valueDoubleFirst * 10) / 10);
  });

  // æ‰¾åˆ°æœ€å¤§æ•™è‚²æŒ‡æ•°ç”¨äºå½’ä¸€åŒ–
  const maxEduIndex = Math.max(...universityData.map(p => p.eduIndex));
  // è®¡ç®—æœ€å¤§åˆ»åº¦å€¼ï¼ˆå‘ä¸Šå–æ•´åˆ°æœ€è¿‘çš„10çš„å€æ•°ï¼‰
  const maxScaleValue = Math.ceil(maxEduIndex / 10) * 10;
  
  // è®¡ç®—å¹³å‡æ•™è‚²æŒ‡æ•°ä½œä¸ºä»ªè¡¨ç›˜å€¼
  const avgEduIndex = Math.round(universityData.reduce((sum, p) => sum + p.eduIndex, 0) / universityData.length);
  
  // å…¨å›½é«˜æ ¡ç±»å‹åˆ†å¸ƒæ•°æ®ï¼ˆé»˜è®¤é¥¼å›¾æ•°æ®ï¼‰
  const pieData = [
    {value: 42, name: 'ç»¼åˆç±»'},
    {value: 28, name: 'ç†å·¥ç±»'},
    {value: 15, name: 'å¸ˆèŒƒç±»'},
    {value: 10, name: 'è´¢ç»ç±»'},
    {value: 5, name: 'å…¶ä»–ç±»'}
  ];

  // çœä»½ä¸“ä¸šçƒ­è¯æ•°æ®
  const provinceKeywords = {
    'åŒ—äº¬å¸‚': [
      {name: 'äººå·¥æ™ºèƒ½', value: 120}, {name: 'å¤§æ•°æ®', value: 95}, {name: 'ç®—æ³•', value: 90},
      {name: 'è½¯ä»¶å·¥ç¨‹', value: 80}, {name: 'ç½‘ç»œå®‰å…¨', value: 78}, {name: 'ç‰©è”ç½‘', value: 60},
      {name: 'äº‘è®¡ç®—', value: 55}, {name: 'æ·±åº¦å­¦ä¹ ', value: 85}, {name: 'å¯è§†åŒ–', value: 65},
      {name: 'æœºå™¨äºº', value: 52}, {name: 'æ•°æ®åº“', value: 58}, {name: 'æ“ä½œç³»ç»Ÿ', value: 61}
    ],
    'ä¸Šæµ·å¸‚': [
      {name: 'é‡‘èç§‘æŠ€', value: 110}, {name: 'å›½é™…è´¸æ˜“', value: 85}, {name: 'ç»æµç®¡ç†', value: 90},
      {name: 'äººå·¥æ™ºèƒ½', value: 75}, {name: 'ç”Ÿç‰©åŒ»å­¦', value: 70}, {name: 'æ–°ææ–™', value: 65},
      {name: 'ç‰©æµç®¡ç†', value: 60}, {name: 'å¸‚åœºè¥é”€', value: 55}, {name: 'ç”µå­å•†åŠ¡', value: 50},
      {name: 'å¤–è¯­', value: 45}, {name: 'æ³•å¾‹', value: 40}, {name: 'è®¾è®¡', value: 35}
    ],
    'é™•è¥¿çœ': [
      {name: 'èˆªç©ºèˆªå¤©', value: 100}, {name: 'æœºæ¢°å·¥ç¨‹', value: 90}, {name: 'ç”µå­ä¿¡æ¯', value: 85},
      {name: 'ææ–™ç§‘å­¦', value: 80}, {name: 'è‡ªåŠ¨åŒ–', value: 75}, {name: 'è®¡ç®—æœº', value: 70},
      {name: 'å…µå™¨ç§‘å­¦', value: 65}, {name: 'èƒ½æºåŠ¨åŠ›', value: 60}, {name: 'åœŸæœ¨å·¥ç¨‹', value: 55},
      {name: 'æ•°å­¦', value: 50}, {name: 'ç‰©ç†', value: 45}, {name: 'åŒ–å­¦', value: 40}
    ],
    'æ±Ÿè‹çœ': [
      {name: 'ç”µå­ä¿¡æ¯', value: 95}, {name: 'æœºæ¢°å·¥ç¨‹', value: 90}, {name: 'ææ–™ç§‘å­¦', value: 85},
      {name: 'è‡ªåŠ¨åŒ–', value: 80}, {name: 'è®¡ç®—æœº', value: 75}, {name: 'ç”Ÿç‰©åŒ»å­¦', value: 70},
      {name: 'åŒ–å·¥', value: 65}, {name: 'åœŸæœ¨å·¥ç¨‹', value: 60}, {name: 'ç»æµç®¡ç†', value: 55},
      {name: 'å¤–è¯­', value: 50}, {name: 'æ³•å¾‹', value: 45}, {name: 'è®¾è®¡', value: 40}
    ],
    'æ¹–åŒ—çœ': [
      {name: 'å…‰ç”µä¿¡æ¯', value: 90}, {name: 'æœºæ¢°å·¥ç¨‹', value: 85}, {name: 'ç”µå­ä¿¡æ¯', value: 80},
      {name: 'ææ–™ç§‘å­¦', value: 75}, {name: 'è‡ªåŠ¨åŒ–', value: 70}, {name: 'è®¡ç®—æœº', value: 65},
      {name: 'ç”Ÿç‰©åŒ»å­¦', value: 60}, {name: 'åœŸæœ¨å·¥ç¨‹', value: 55}, {name: 'æ°´åˆ©æ°´ç”µ', value: 50},
      {name: 'ç»æµç®¡ç†', value: 45}, {name: 'æ³•å¾‹', value: 40}, {name: 'æ–°é—»', value: 35}
    ],
    'å¹¿ä¸œçœ': [
      {name: 'ç”µå­ä¿¡æ¯', value: 95}, {name: 'è®¡ç®—æœº', value: 90}, {name: 'äººå·¥æ™ºèƒ½', value: 85},
      {name: 'ç»æµç®¡ç†', value: 80}, {name: 'é‡‘è', value: 75}, {name: 'å›½é™…è´¸æ˜“', value: 70},
      {name: 'ç”Ÿç‰©åŒ»å­¦', value: 65}, {name: 'æ–°ææ–™', value: 60}, {name: 'è‡ªåŠ¨åŒ–', value: 55},
      {name: 'è®¾è®¡', value: 50}, {name: 'å¤–è¯­', value: 45}, {name: 'æ—…æ¸¸', value: 40}
    ],
    'å››å·çœ': [
      {name: 'ç”µå­ä¿¡æ¯', value: 90}, {name: 'è®¡ç®—æœº', value: 85}, {name: 'äººå·¥æ™ºèƒ½', value: 80},
      {name: 'æœºæ¢°å·¥ç¨‹', value: 75}, {name: 'ææ–™ç§‘å­¦', value: 70}, {name: 'ç”Ÿç‰©åŒ»å­¦', value: 65},
      {name: 'æ°´åˆ©æ°´ç”µ', value: 60}, {name: 'åœŸæœ¨å·¥ç¨‹', value: 55}, {name: 'ç»æµç®¡ç†', value: 50},
      {name: 'æ—…æ¸¸', value: 45}, {name: 'å¤–è¯­', value: 40}, {name: 'æ³•å¾‹', value: 35}
    ],
    'å…¨å›½': [
      {name: 'äººå·¥æ™ºèƒ½', value: 120}, {name: 'å¤§æ•°æ®', value: 95}, {name: 'ç®—æ³•', value: 90},
      {name: 'è½¯ä»¶å·¥ç¨‹', value: 80}, {name: 'ç½‘ç»œå®‰å…¨', value: 78}, {name: 'ç‰©è”ç½‘', value: 60},
      {name: 'äº‘è®¡ç®—', value: 55}, {name: 'æ·±åº¦å­¦ä¹ ', value: 85}, {name: 'å¯è§†åŒ–', value: 65},
      {name: 'æœºå™¨äºº', value: 52}, {name: 'æ•°æ®åº“', value: 58}, {name: 'æ“ä½œç³»ç»Ÿ', value: 61}
    ]
  };

  // é»˜è®¤çƒ­è¯æ•°æ®ï¼ˆå…¨å›½ï¼‰
  let currentWordCloudData = provinceKeywords['å…¨å›½'];

  // é›·è¾¾å›¾æŒ‡æ ‡æ•°æ®
  const radarIndicators = [
    { name: 'åŠå­¦èµ„æº', max: 100 },
    { name: 'äººæ‰åŸ¹å…»', max: 100 },
    { name: 'ç§‘å­¦ç ”ç©¶', max: 100 },
    { name: 'ç¤¾ä¼šæœåŠ¡', max: 100 },
    { name: 'é‡å¤§é¡¹ç›®ä¸æˆæœ', max: 100 },
    { name: 'å›½é™…ç«äº‰åŠ›', max: 100 }
  ];

  // ç”Ÿæˆçœä»½çš„é›·è¾¾å›¾æ•°æ®
  function generateRadarData(provinceName) {
    if (provinceName === 'å…¨å›½') {
      // å…¨å›½å¹³å‡å€¼
      return {
        name: 'å…¨å›½å¹³å‡',
        value: [75, 80, 85, 70, 65, 60]
      };
    }
    
    const province = universityData.find(p => p.name === provinceName);
    if (!province) {
      return {
        name: provinceName,
        value: [50, 50, 50, 50, 50, 50]
      };
    }
    
    // æ ¹æ®çœä»½çš„985/211/åŒä¸€æµæ•°é‡ç­‰æ•°æ®ç”Ÿæˆé›·è¾¾å›¾å€¼
    const baseValue = province.eduIndex / 10;
    const value985 = province.value985 * 3;
    const value211 = province.value211 * 2;
    const valueDoubleFirst = province.valueDoubleFirst * 1.5;
    
    return {
      name: provinceName,
      value: [
        Math.min(100, baseValue * 6 + value985 + value211 + valueDoubleFirst), // åŠå­¦èµ„æº
        Math.min(100, baseValue * 7 + value211 * 1.5 + valueDoubleFirst),      // äººæ‰åŸ¹å…»
        Math.min(100, baseValue * 8 + value985 * 2 + valueDoubleFirst),        // ç§‘å­¦ç ”ç©¶
        Math.min(100, baseValue * 5 + value211 + valueDoubleFirst),            // ç¤¾ä¼šæœåŠ¡
        Math.min(100, baseValue * 4 + value985 * 3 + valueDoubleFirst),        // é‡å¤§é¡¹ç›®ä¸æˆæœ
        Math.min(100, baseValue * 5 + value985 * 2 + valueDoubleFirst)         // å›½é™…ç«äº‰åŠ›
      ]
    };
  }

  // å›¾è¡¨ 1ï¼šä»ªè¡¨ç›˜ - æ˜¾ç¤ºæ•™è‚²æŒ‡æ•°
  const gauge = init('gauge');
  let currentGaugeValue = avgEduIndex;
  let currentGaugeName = 'å…¨å›½å¹³å‡æ•™è‚²æŒ‡æ•°';
  
  function updateGauge(value, name) {
    currentGaugeValue = value;
    currentGaugeName = name;
    gauge.setOption({
      series: [{
        data: [{ value: value, name: name }]
      }]
    });
  }
  
  // è®¡ç®—åˆ†å‰²æ•°ï¼ˆæ¯10ä¸€ä¸ªåˆ»åº¦ï¼‰
  const splitNumber = maxScaleValue / 10;
  
  gauge.setOption({
    tooltip: {},
    series: [{
      type: 'gauge',
      center: ['50%', '60%'],
      radius: '80%',
      startAngle: 210, endAngle: -30,
      min: 0, max: maxScaleValue, splitNumber: splitNumber,
      axisLine: { 
        lineStyle: { 
          width: 20,
          color: [
            [0.3, '#ff6e76'],
            [0.7, '#fddd60'],
            [1, '#4fc3f7']
          ]
        } 
      },
      axisTick: { 
        distance: 0,  // è°ƒæ•´åˆ»åº¦çº¿ä½ç½®
        length: 6,
        lineStyle: { 
          color: '#dbe5ff',
            width: 1
        }
      },
      splitLine: {
        distance: -20,  // è°ƒæ•´åˆ»åº¦åˆ†å‰²çº¿ä½ç½®
        length: 10,
        lineStyle: { 
          color: 'auto',
          width: 2
        }
      },
      axisLabel: { 
        distance: -10,  // å°†æ ‡ç­¾ç§»åˆ°ä»ªè¡¨ç›˜å†…éƒ¨
        color: '#dbe5ff',
        fontSize: 10,
        fontWeight: 'bold',
        formatter: function(value) {
          // åªæ˜¾ç¤º10çš„å€æ•°
          return value % 10 === 0 ? value : '';
        }
      },
      pointer: { 
        width: 6, 
        length: '70%',
        itemStyle: { 
          color: 'auto',
          shadowColor: 'rgba(0, 0, 0, 0.5)',
          shadowBlur: 5,
          shadowOffsetX: 2,
        shadowOffsetY: 2
        }
      },
      detail: { 
        valueAnimation: true, 
        fontSize: 28,
        fontWeight: 'bold',
        offsetCenter: [0, '70%'],  // å°†æ•°å€¼ç§»åˆ°ä»ªè¡¨ç›˜ä¸‹æ–¹
        formatter: '{value}',
        color: '#dbe5ff'
      },
      title: { 
        fontSize: 14, 
        offsetCenter: [0, '30%'],
        color: '#90c4ff'
      },
      data: [{ value: currentGaugeValue, name: currentGaugeName }]
    }]
  });

  // å›¾è¡¨ 2ï¼šé¥¼å›¾ - é«˜æ ¡ç±»å‹åˆ†å¸ƒ
  const pie = init('pie');
  
  // æ›´æ–°é¥¼å›¾å‡½æ•°
  function updatePieChart(provinceName) {
    if (provinceName === 'å…¨å›½') {
      // æ˜¾ç¤ºå…¨å›½æ•°æ®
      pie.setOption({
        tooltip: { trigger: 'item' },
        legend: { top: 0, textStyle: { color: '#dbe5ff' } },
        color: ['#4fc3f7', '#7c4dff', '#ff6b81', '#ffa726', '#66bb6a'],
        series: [{
          type: 'pie', 
          radius: ['35%', '65%'], 
          center: ['50%', '58%'],
          roseType: false, 
          itemStyle: { borderColor: '#0e1830', borderWidth: 2 },
          label: { formatter: '{b}\n{d}%', color: '#dbe5ff' },
          data: pieData
        }]
      });
      return;
    }
    
    // æŸ¥æ‰¾çœä»½æ•°æ®
    const province = universityData.find(p => p.name === provinceName);
    if (province && province.types) {
      pie.setOption({
        tooltip: { trigger: 'item' },
        legend: { top: 0, textStyle: { color: '#dbe5ff' } },
        color: ['#4fc3f7', '#7c4dff', '#ff6b81', '#ffa726', '#66bb6a'],
        series: [{
          type: 'pie', 
          radius: ['35%', '65%'], 
          center: ['50%', '58%'],
          roseType: false, 
          itemStyle: { borderColor: '#0e1830', borderWidth: 2 },
          label: { formatter: '{b}\n{d}%', color: '#dbe5ff' },
          data: province.types
        }]
      });
    }
  }
  
  // åˆå§‹åŒ–é¥¼å›¾
  updatePieChart('å…¨å›½');

  // å›¾è¡¨ 3ï¼šé›·è¾¾å›¾ - é«˜æ ¡ç»¼åˆå®åŠ›
  const radar = init('radar');
  
  // æ›´æ–°é›·è¾¾å›¾å‡½æ•°
  function updateRadarChart(provinceName) {
    const radarData = generateRadarData(provinceName);
    
    radar.setOption({
      tooltip: {},
      legend: {
        data: [provinceName],
        textStyle: { color: '#dbe5ff' },
        // ä¿®æ”¹å›¾ä¾‹ä½ç½®åˆ°å·¦ä¾§
        left: 'left',
        top: 'middle',
        orient: 'vertical'
      },
      radar: {
        indicator: radarIndicators,
        shape: 'polygon',
        splitNumber: 5,
        // è°ƒæ•´é›·è¾¾å›¾ä½ç½®ï¼Œä¸ºå·¦ä¾§å›¾ä¾‹ç•™å‡ºç©ºé—´
        center: ['60%', '50%'],
        radius: '60%',
        axisName: {
          color: '#dbe5ff'
        },
        splitLine: {
          lineStyle: {
            color: 'rgba(211, 253, 250, 0.8)'
          }
        },
        splitArea: {
          show: true,
          areaStyle: {
            color: ['rgba(79, 195, 247, 0.05)', 'rgba(124, 77, 255, 0.05)']
          }
        },
        axisLine: {
          lineStyle: {
            color: 'rgba(211, 253, 250, 0.8)'
          }
        }
      },
      series: [{
        name: provinceName,
        type: 'radar',
        data: [radarData],
        color: ['#4fc3f7'],
        areaStyle: {
          color: new echarts.graphic.RadialGradient(0.5, 0.5, 1, [
            { offset: 0, color: 'rgba(79, 195, 247, 0.5)' },
            { offset: 1, color: 'rgba(79, 195, 247, 0.1)' }
          ])
        },
        lineStyle: {
          width: 2,
          color: '#4fc3f7'
        },
        symbol: 'circle',
        symbolSize: 8,
        label: {
          show: false // ä¸æ˜¾ç¤ºæ¯ä¸ªæŒ‡æ ‡çš„åˆ†æ•°
        }
      }]
    });
  }
  
  // åˆå§‹åŒ–é›·è¾¾å›¾
  updateRadarChart('å…¨å›½');

  // å›¾è¡¨ 4ï¼šè¯äº‘
  const wordcloud = init('wordcloud');
  
  // æ›´æ–°è¯äº‘å‡½æ•°
  function updateWordCloud(provinceName) {
    // è·å–å¯¹åº”çœä»½çš„çƒ­è¯æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨å…¨å›½æ•°æ®
    const wordData = provinceKeywords[provinceName] || provinceKeywords['å…¨å›½'];
    currentWordCloudData = wordData;
    
    wordcloud.setOption({
      tooltip: {},
      series: [{
        type: 'wordCloud',
        shape: 'circle',
        gridSize: 8,
        sizeRange: [12, 36],
        rotationRange: [-45, 90],
        textStyle: { 
          color: () => '#'+Math.floor(Math.random()*0xffffff).toString(16).padStart(6,'0') 
        },
        data: wordData
      }]
    });
  }
  
  // åˆå§‹åŒ–è¯äº‘
  updateWordCloud('å…¨å›½');

  // å›¾è¡¨ 5ï¼šä¸­å›½åœ°å›¾
  const map = init('map');
  
  // åŠ è½½ä¸­å›½åœ°å›¾æ•°æ®
  function loadChinaMap() {
    fetch('https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json')
      .then(response => response.json())
      .then(geoJson => {
        // æ³¨å†Œä¸­å›½åœ°å›¾
        echarts.registerMap('china', geoJson);
        
        // å‡†å¤‡åœ°å›¾æ•°æ®
        const chinaData = universityData.map(province => ({
          name: province.name,
          value: province.eduIndex,
          value985: province.value985,
          value211: province.value211,
          valueDoubleFirst: province.valueDoubleFirst
        }));
        
        // æ·»åŠ å¯èƒ½ç¼ºå¤±çš„åœ°åŒº
        const additionalRegions = [
          {name: 'å°æ¹¾', value: 30, value985: 0, value211: 0, valueDoubleFirst: 0},
          {name: 'é¦™æ¸¯', value: 50, value985: 0, value211: 0, valueDoubleFirst: 0},
          {name: 'æ¾³é—¨', value: 40, value985: 0, value211: 0, valueDoubleFirst: 0}
        ];
       
        // è®¾ç½®åœ°å›¾é€‰é¡¹
        map.setOption({
          tooltip: {
            trigger: 'item',
            formatter: function(params) {
              if (params.data) {
                return `${params.name}<br/>æ•™è‚²æŒ‡æ•°ï¼š${params.data.value}<br/>985é«˜æ ¡ï¼š${params.data.value985 || 0}<br/>211é«˜æ ¡ï¼š${params.data.value211 || 0}<br/>åŒä¸€æµé«˜æ ¡ï¼š${params.data.valueDoubleFirst || 0}`;
              }
              return `${params.name}<br/>æ•™è‚²æŒ‡æ•°ï¼šæš‚æ— æ•°æ®`;
            }
          },
          visualMap: {
            type: 'continuous',
            left: 'left',
            min: 0,
            max: maxScaleValue,
            text: ['é«˜', 'ä½'],
            calculable: true,
            inRange: {
              color: ['#e0f3ff', '#4fc3f7', '#006edd', '#003d82']
            },
            textStyle: {
              color: '#dbe5ff'
            }
          },
          series: [
            {
              name: 'ä¸­å›½æ•™è‚²å‘å±•æŒ‡æ•°',
              type: 'map',
              map: 'china',
              roam: true,
              scaleLimit: {
                min: 0.8,
                max: 5
              },
              data: [...chinaData, ...additionalRegions],
              label: {
                show: false
              },
              itemStyle: {
                areaColor: '#112345',
                borderColor: '#4fc3f7',
                borderWidth: 0.5
              },
              emphasis: {
                label: {
                  show: true,
                  fontSize: 11,
                  color: '#fff',
                  fontWeight: 'bold'
                },
                itemStyle: {
                  areaColor: '#1f3d6b',
                  borderColor: '#7c4dff',
                  borderWidth: 1.5,
                  shadowBlur: 10,
                  shadowColor: 'rgba(0,0,0,0.5)'
                }
              },
              select: {
                itemStyle: {
                  areaColor: '#7c4dff',
                  borderColor: '#fff',
                  borderWidth: 2
                },
                label: {
                  show: true,
                  color: '#fff',
                  fontSize: 12,
                  fontWeight: 'bold'
                }
              }
            }
          ]
        });
        
        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
        map.on('click', function(params) {
          const provinceName = params.name;
          const provinceData = [...universityData, ...additionalRegions].find(p => p.name === provinceName);
          
          if (provinceData) {
            // æ›´æ–°ä»ªè¡¨ç›˜
            updateGauge(provinceData.eduIndex, provinceName + 'æ•™è‚²æŒ‡æ•°');
            
            // æ›´æ–°é¥¼å›¾
            updatePieChart(provinceName);
            
            // æ›´æ–°é›·è¾¾å›¾
            updateRadarChart(provinceName);
            
            // æ›´æ–°è¯äº‘
            updateWordCloud(provinceName);
            
            // æ˜¾ç¤ºçœä»½ä¿¡æ¯
            document.getElementById('provinceName').textContent = provinceName;
            document.getElementById('985Count').textContent = provinceData.value985 || 0;
            document.getElementById('211Count').textContent = provinceData.value211 || 0;
            document.getElementById('doubleFirstCount').textContent = provinceData.valueDoubleFirst || 0;
            document.getElementById('eduIndex').textContent = provinceData.eduIndex || 0;
            
            // æ˜¾ç¤ºä¿¡æ¯é¢æ¿
            document.getElementById('provinceInfo').style.display = 'block';
            
            // é«˜äº®å½“å‰é€‰ä¸­çš„çœä»½
            map.dispatchAction({
              type: 'mapSelect',
              name: provinceName
            });
            
            // æ”¾å¤§åˆ°é€‰ä¸­çœä»½
            map.dispatchAction({
              type: 'mapRoam',
              zoom: 3,
              center: map.convertToPixel('geo', params.event.eventOffset)
            });
          }
        });
      })
      .catch(error => {
        console.error('åŠ è½½ä¸­å›½åœ°å›¾å¤±è´¥:', error);
        // é™çº§æ–¹æ¡ˆ
        map.setOption({
          tooltip: { trigger: 'item' },
          geo: {
            map: 'world',
            roam: true,
            label: { show: false },
            itemStyle: { areaColor: '#112345', borderColor: '#335' },
            emphasis: { itemStyle: { areaColor: '#1f3d6b' } }
          }
        });
      });
  }
  
  // åˆå§‹åŒ–ä¸­å›½åœ°å›¾
  loadChinaMap();

  // å…³é—­çœä»½ä¿¡æ¯é¢æ¿
  document.querySelector('.close-btn').addEventListener('click', function() {
    document.getElementById('provinceInfo').style.display = 'none';
    
    // å…³é”®ä¿®æ”¹ï¼šæ­£ç¡®é‡ç½®åœ°å›¾çŠ¶æ€çš„ä¸‰æ­¥æ“ä½œ
    // 1. å–æ¶ˆæ‰€æœ‰é€‰ä¸­çŠ¶æ€
    map.dispatchAction({
      type: 'unselect',
      seriesIndex: 0
    });
    
    // 2. å–æ¶ˆé«˜äº®çŠ¶æ€
    map.dispatchAction({
      type: 'downplay',
      seriesIndex: 0
    });
    
    // 3. é‡ç½®åœ°å›¾åˆ°åˆå§‹è§†å›¾
    map.dispatchAction({
      type: 'restore'
    });
    
    // é‡ç½®ä»ªè¡¨ç›˜ä¸ºå…¨å›½å¹³å‡å€¼
    updateGauge(avgEduIndex, 'å…¨å›½å¹³å‡æ•™è‚²æŒ‡æ•°');
    
    // é‡ç½®é¥¼å›¾ä¸ºå…¨å›½æ•°æ®
    updatePieChart('å…¨å›½');
    
    // é‡ç½®é›·è¾¾å›¾ä¸ºå…¨å›½æ•°æ®
    updateRadarChart('å…¨å›½');
    
    // é‡ç½®è¯äº‘ä¸ºå…¨å›½æ•°æ®
    updateWordCloud('å…¨å›½');
  });

  // è‡ªé€‚åº”
  const charts = [gauge, pie, radar, wordcloud, map];
  window.addEventListener('resize', () => charts.forEach(c => c.resize()));
  
  // æ·»åŠ é¢æ¿æ‚¬åœæ•ˆæœ
  document.querySelectorAll('.panel').forEach(panel => {
    panel.addEventListener('mouseenter', () => {
      panel.classList.add('highlight');
    });
    panel.addEventListener('mouseleave', () => {
      panel.classList.remove('highlight');
    });
  });
</script>
</body>
</html>